## 一切参数仅以此程序为准，_无其他参考价值_

## 此程序仅用于学习编程，<font color=red>**不参与任何商业行为**</font>

### 注意事项

- 使用 vscode 运行 pyatuogui 模块点击其他程序窗口，需要使用**管理员**运行 vscode
- **锁定阵容**进入游戏
- 游戏内未开启个性化结算，没有验证是否影响程序
- 本人使用清明或小清明，其他未验证
- 多人组队需要先打一把，将所有自动设置打开（默认邀请，默认接受）
- ~~开始后尽量不操作鼠标~~
- 建议使用默认大小使用
- 暂不支持多开
- 混土使用暂时测试无误

### 程序使用

- onmyojiApi<font color=red>**挑战按钮坐标（中间位置）**</font>（暂时需要通过其他软件读取坐标）
- 设定 <font color=red>**魂土时间**</font>（阵容时间）
- 设定 <font color=red>**副本名称**</font>（暂时默认魂土）
- 设定 <font color=red>**次数**</font>
- 战斗时，程序开启子线程随时（设置间隔时间）随机移动鼠标
- 战斗结束（主线程结束），子线程立即结束

---

### 测试记录

> - 开始动画 4.61-4.76 按 5s 计算 不用加调整
> - 一局的时间 one_time 调整 1s 左右，模拟卡顿情况
> - 结束动画 2s 左右 不需要加调整
> - 上述时间统计为一局的时间 front = 7 + one_time
> - 经历 front 到达最后展示阵容界面（没有开启结算个性化）
> - 此时开始执行结束部分的 3 次点击
> - 结束后出现阵容，到结算结束，大概
> - 传入御魂时间 one_time 阴阳师界面显示的时间
> - 在最后使用两种方式结束
>
> - 魂土单人挑战按钮占比(0.91304 0.94538)
> - 魂土组队->队长挑战按钮占比(0.95304 0.94538)
> - 不要最小化游戏窗口！
> - 无视缩放，不建议缩放过小，win32 模块 只接受 int，缩放过小，因取整的问题导致偏移过大

---

> - 固定阵容使用
> - 困 28 采用：opencv-python 的模板匹配算法 Template Matching(<font color='gray'>经过测试匹配度 95%-考虑后续将 huntu 策略换成匹配按钮，舍弃时间策略</font>)
> - 教程：https://www.jianshu.com/p/5f4bb5c78184
> - 目前是一次获取一个战斗，一次获取多个参考https://www.jianshu.com/p/53ef74b02f6a
> - 同时配合 python 自动化 pyautogui 和 win32 进行点击等操作
> - 可以用*小比例*窗口中战斗图片的截图去匹配*大比例*窗口，反之不行
> - ~~TODO：发光战斗图片无法匹配，在开始前准备截图小，不触碰发光圈~~
> - ~~TODO：副本中怪移动过快，鼠标点击不到~~
> - TODO：进入副本画面不能完全展示所有怪物，中途需要进行移动

## 测试时间用例

> ~~三连击，间隔 0.5s~~  
> ~~等待 7s 后点击一次~~  
> ~~开始动画--4.639640808105469~~  
> ~~结束动画--27.392405033111572~~  
> ~~结算页面--29.175340175628662~~  
> ~~结算时间--9.368106603622437~~  
> ~~total_time--38.5434467792511~~

---

## 副本对应名称

```json
{
  "魂土": "hun11"
}
```

## role/情况对应名称

```json
{
  "1": "单人作队长",
  "21": "组队作队长",
  "22": "组队非队长：进入插画启动程序"
}
```

---

## _*TODO*_

- urgent：程序开始前，对游戏窗口进行缩放限制，以便程序更好运行->日后更改逻辑解除限制
- 将代码窗口最小化(需要添加监听键盘操作，防止不能结束程序)
- ~~战斗途中，窗口移动问题~~
- 按比例对鼠标点击位置进行波动(每次点击时查询窗口大小/原始窗口大小,click 时对鼠标位置\*比例)
- ~~调整随机鼠标位置，防止触碰边角~~
- 执行，click 之前检测用户窗口大小，过小（随机偏移超出画面）自动调整窗口大小
- ~~组队队长窗口，一局结束最后无法进行双击确定，会点到个人信息，采用开始按钮左移部分比例，定位鼠标 0.86304~~
- 开始判定：目前使用时间（如果点击后，没有进行战斗，则后面逻辑全失效），需要增加判定
- ~~魂土组队模式开发（例如：按钮占比作参）~~
- 设定结束判断（如读取图片判断，或者更加严谨的时间判断）
- 其他副本开发，困 28
- 异常处理，例如最小化 click 会出错，处理为可理解形式
- print 进度条，配备 log 使用
- ~~程序自动获取鼠标位置（初始位置不用通过其他软件读取）~~
- 多开（各窗口时间设定）
- 操作界面

---

- 困 28
- 本地目录结构与 github 不同，需要调整远程仓库目录结构\\autoClick\\static
- 使用线程判定是否出现结算，判定成功则进行点击
- 目前测试，画面中出现按钮都可以进行点击，但是在没有目标是也会误点击
- 目前是人工截取各部分按钮图片，改进为程序开始后，按比例位置截取可以避免缩放对程序影响
